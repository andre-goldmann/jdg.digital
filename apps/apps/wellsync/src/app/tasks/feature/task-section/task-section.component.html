<div class="task-section-container">
  <!-- Header -->
  <app-nav-bar></app-nav-bar>

  <!-- Main Content -->
  <div class="content">
    <!-- Tasks Header -->
    <div class="section-header">
      <h1>Your Daily Tasks</h1>
      <div class="stats-summary">
        <div class="stat-item">
          <span class="stat-value">{{ taskStore.completedCount() }}</span>
          <span class="stat-label">Completed</span>
        </div>
        <div class="stat-item">
          <span class="stat-value"
            >{{ taskStore.habitCount() }}/{{ taskStore.totalHabits() }}</span
          >
          <span class="stat-label">Habits</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ taskStore.completionRate() }}%</span>
          <span class="stat-label">Completion</span>
        </div>
      </div>
    </div>

    <!-- Add Task Form -->
    <div class="add-task-container">
      <mat-form-field appearance="outline" class="task-input">
        <mat-label>Add a new task</mat-label>
        <input
          matInput
          [(ngModel)]="newTask"
          placeholder="What do you need to do?"
          (keyup.enter)="addTask()"
        />
        <mat-icon matSuffix>add_task</mat-icon>
      </mat-form-field>
      <button
        mat-raised-button
        color="primary"
        (click)="addTask()"
        [disabled]="!newTask.trim()"
      >
        Add Task
      </button>
    </div>

    <!-- Task List -->
    <div class="task-list">
      @if (taskStore.loading()) {
      <div class="loading">Loading tasks...</div>
      } @else if (taskStore.tasksEntities().length === 0) {
      <div class="empty-state">
        <mat-icon>check_circle_outline</mat-icon>
        <p>No tasks yet. Add your first task above!</p>
      </div>
      } @else { @for (task of taskStore.tasksEntities(); track task.id) {
      <mat-card class="task-card" [class.completed]="task.completed">
        <mat-card-content>
          <div class="task-content">
            <mat-checkbox
              [checked]="task.completed"
              (change)="toggleTask(task.id)"
            >
              <span [class.task-completed]="task.completed">{{
                task.text
              }}</span>
            </mat-checkbox>

            @if (task.isHabit) {
            <div class="habit-badge">Habit</div>
            }
          </div>
        </mat-card-content>
      </mat-card>
      } }
    </div>
  </div>
</div>
